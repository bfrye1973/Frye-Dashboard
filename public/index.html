<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width,initial-scale=1,shrink-to-fit=no,viewport-fit=cover"
    />
    <title>Frye Dashboard</title>
    <meta name="theme-color" content="#0d1117" />
    <meta name="color-scheme" content="dark" />

    <!-- ========================= BACKEND CONFIG ========================= -->
    <script>
      /* Market/quotes backend (already used by the chart layer) */
      window.__API_BASE__ = "https://frye-market-backend-1.onrender.com";

      /* TOS REST base (HTTP polling or fallback) */
      window.__TOS_BASE__ = "https://frye-market-backend-1.onrender.com";

      /* TOS WebSocket base (preferred). If no WS yet, set "" */
      window.__TOS_WS_BASE__ = "wss://frye-market-backend-1.onrender.com";

      /* Optional: Bearer token if your server requires auth */
      window.__TOS_TOKEN__ = ""; // keep empty unless REQUIRE_TOKEN=1

      /* ---- diagnostics banner so you can verify after deploy ---- */
      (function () {
        const tag = "%c[BOOT]";
        const style = "color:#22d3ee;font-weight:700";
        try {
          console.log(tag, style, "Frye Dashboard");
          console.log("%c API_BASE     ", "color:#a3e635", window.__API_BASE__ || "(unset)");
          console.log("%c TOS_BASE     ", "color:#a3e635", window.__TOS_BASE__ || "(unset)");
          console.log("%c TOS_WS_BASE  ", "color:#a3e635", window.__TOS_WS_BASE__ || "(unset)");
          console.log("%c TOS_TOKEN    ", "color:#a3e635", window.__TOS_TOKEN__ ? "(provided)" : "(none)");
        } catch (e) {}
      })();
    </script>

    <!-- ==== ZOOM NORMALIZER & DEBUG ==== -->
    <meta id="vp" name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <script>
      (function () {
        var probe = document.createElement('div');
        probe.style.width = '1in';
        probe.style.height = '1in';
        probe.style.position = 'absolute';
        probe.style.left = '-9999px';
        document.documentElement.appendChild(probe);
        var cssPPI = probe.offsetWidth || 96;
        probe.remove();
        var dpr = window.devicePixelRatio || 1;
        window.__SCALE_DEBUG__ = { cssPPI: cssPPI, dpr: dpr };

        if (cssPPI > 130 || cssPPI < 80) {
          var vp = document.getElementById('vp');
          if (vp) vp.setAttribute('content', 'width=device-width, initial-scale=1, maximum-scale=1');
          document.documentElement.classList.add('zoom-reset-tmp');
          setTimeout(function () {
            document.documentElement.classList.remove('zoom-reset-tmp');
          }, 50);
        }
      })();
    </script>
    <!-- ==== END ZOOM NORMALIZER ==== -->

    <!-- ==== ANTI-100VH INLINE SANITIZER ==== -->
    <script>
      (function() {
        function scrub(el) {
          try {
            var s = el.style; if (!s) return;
            var mh = (s.minHeight || "").replace(/\s/g, "");
            var h  = (s.height    || "").replace(/\s/g, "");
            if (mh === "100vh" || h === "100vh") {
              s.setProperty("min-height", "auto", "important");
              s.setProperty("height", "auto", "important");
              s.setProperty("max-height", "92vh", "important");
              s.setProperty("overflow", "hidden", "important");
            }
          } catch(_) {}
        }

        // scrub existing nodes
        document.querySelectorAll("*[style]").forEach(scrub);

        // watch for future style changes / added nodes
        var mo = new MutationObserver(function(muts){
          for (var i=0;i<muts.length;i++){
            var m = muts[i];
            if (m.type === "attributes" && m.attributeName === "style") {
              scrub(m.target);
            } else if (m.addedNodes && m.addedNodes.length) {
              m.addedNodes.forEach(function(n){
                if (n && n.nodeType === 1) {
                  if (n.hasAttribute && n.hasAttribute("style")) scrub(n);
                  if (n.querySelectorAll) n.querySelectorAll("*[style]").forEach(scrub);
                }
              });
            }
          }
        });
        mo.observe(document.documentElement, {
          subtree: true, childList: true, attributes: true, attributeFilter: ["style"]
        });
      })();
    </script>
    <!-- ==== END ANTI-100VH INLINE SANITIZER ==== -->

    <!-- Optional CSP while developing (loosened). Tighten for prod. -->
    <!--
    <meta http-equiv="Content-Security-Policy"
          content="default-src 'self' * blob: data: ws: wss:;
                   script-src 'self' 'unsafe-inline' 'unsafe-eval' *;
                   connect-src * ws: wss:;
                   img-src * data: blob:;
                   style-src * 'unsafe-inline';">
    -->

    <style>
      html, body, #root { height: 100%; }
      body {
        margin: 0;
        background: #0d1117;
        color: #d1d4dc;
        font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
      }
      /* Sharper SVG + text on the gauges */
      svg, text {
        shape-rendering: geometricPrecision;
        text-rendering: geometricPrecision;
      }
      noscript {
        color: #d1d4dc;
        background: #0d1117;
        display: block;
        padding: 12px;
      }
    </style>
  </head>
  <body>
    <noscript>This app requires JavaScript to run.</noscript>
    <div id="root" data-build="Step1-TOS-Link"></div>
    <!-- Your bundler will inject the compiled app script here -->
  </body>
</html>
